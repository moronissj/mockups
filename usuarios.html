<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabla de Usuarios</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <img src="/assets/Logo.svg" style="height: 75px; width: 100px;" alt="Logo">
            <button class="navbar-toggler btn btn-outline-primary" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Gestion de recursos</a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="#">Productos</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#">Categorías</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#">Stock</a></li>
                        </ul>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="#">Ventas</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Usuarios</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Envios</a></li>
                </ul>
                <form class="d-flex">
                    <a class="nav-link" href="/login.html">Cerrar sesión</a>
                </form>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h2>Lista de Usuarios</h2>
        <div class="d-flex mb-2">
            <select class="form-select me-2" id="sortName" onchange="sortTable('name')">
                <option value="asc">Ordenar Nombre A-Z</option>
                <option value="desc">Ordenar Nombre Z-A</option>
            </select>
            <select class="form-select me-2" id="sortEmail" onchange="sortTable('email')">
                <option value="asc">Ordenar Email A-Z</option>
                <option value="desc">Ordenar Email Z-A</option>
            </select>
            <select class="form-select me-2" id="sortPhone" onchange="sortTable('phone')">
                <option value="asc">Ordenar Teléfono 0-9</option>
                <option value="desc">Ordenar Teléfono 9-0</option>
            </select>
            <input type="date" class="form-control" id="dateFilter" onchange="filterByDate()" placeholder="Filtrar por fecha">
            <input class="form-control me-2" type="search" placeholder="Buscar" aria-label="Search">
            <button class="btn btn-outline-primary" type="submit">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                </svg>
            </button>
        </div>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Email</th>
                        <th>Teléfono</th>
                        <th>Fecha de Registro</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="userTableBody">
                    <!-- Aquí se inyectarán las filas de usuarios de forma dinámica -->
                </tbody>
            </table>
        </div>

        <!-- Paginación -->
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center" id="pagination">
                <!-- Aquí se inyectarán los elementos de paginación -->
            </ul>
        </nav>
    </div>

    <script>
        const users = Array.from({ length: 100 }, (v, i) => ({
            id: i + 1,
            name: `Usuario ${i + 1}`,
            email: `usuario${i + 1}@ejemplo.com`,
            phone: `123-456-789${i % 10}`,
            registrationDate: `2024-10-${(i % 30) + 1}`,
            status: i % 2 === 0 ? 'bloqueado' : 'desbloqueado'
        }));

        const rowsPerPage = 10;
        let currentPage = 1;
        let filteredUsers = [...users];

        function sortTable(column) {
            const order = document.getElementById(`sort${column.charAt(0).toUpperCase() + column.slice(1)}`).value;
            filteredUsers.sort((a, b) => {
                if (order === 'asc') {
                    return a[column].localeCompare(b[column]);
                } else {
                    return b[column].localeCompare(a[column]);
                }
            });
            renderTable(currentPage);
        }

        function filterByDate() {
            const dateValue = document.getElementById('dateFilter').value;
            filteredUsers = users.filter(user => 
                !dateValue || user.registrationDate === dateValue
            );
            renderTable(currentPage);
            renderPagination();
        }

        function toggleStatus(userId) {
            const user = users.find(user => user.id === userId);
            if (user) {
                user.status = user.status === 'bloqueado' ? 'desbloqueado' : 'bloqueado';
                renderTable(currentPage);
            }
        }

        function renderTable(page) {
            const start = (page - 1) * rowsPerPage;
            const end = start + rowsPerPage;
            const paginatedUsers = filteredUsers.slice(start, end);

            const tableBody = document.getElementById('userTableBody');
            tableBody.innerHTML = '';

            paginatedUsers.forEach(user => {
                const row = `
                    <tr>
                        <td>${user.id}</td>
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td>${user.phone}</td>
                        <td>${user.registrationDate}</td>
                        <td>
                            <button class="btn ${user.status === 'bloqueado' ? 'btn-warning' : 'btn-danger'} btn-sm" 
                                    onclick="toggleStatus(${user.id})">
                                ${user.status === 'bloqueado' ? 'Desbloquear' : 'Bloquear'}
                            </button>
                        </td>
                    </tr>
                `;
                tableBody.insertAdjacentHTML('beforeend', row);
            });
        }

        function renderPagination() {
            const totalPages = Math.ceil(filteredUsers.length / rowsPerPage);
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';

            for (let i = 1; i <= totalPages; i++) {
                const pageItem = `
                    <li class="page-item ${i === currentPage ? 'active' : ''}">
                        <a class="page-link" href="#" onclick="goToPage(${i})">${i}</a>
                    </li>
                `;
                pagination.insertAdjacentHTML('beforeend', pageItem);
            }
        }

        function goToPage(page) {
            currentPage = page;
            renderTable(page);
            renderPagination();
        }

        sortTable('name');
        filterByDate();
        renderTable(currentPage);
        renderPagination();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
